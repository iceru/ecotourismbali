import{r as y,q as C,W as O,b as r,j as m,t as f}from"./app-6ec9350d.js";import{A as w}from"./id-ccd839e6.js";import{M as A}from"./MemberLayout-755106fc.js";import M from"./TitleSection-136008bf.js";import{P as N}from"./PrimaryButton-ac31ca70.js";import{l as T}from"./lodash-a794158e.js";import{u as D}from"./useTranslation-66a8d812.js";import"./index-7306ceaf.js";import"./react-responsive-4d7fabe1.js";function Q({assessments:p,session:d,answers:g}){const[o,k]=y.useState(0),{t:v,i18n:$}=D(),{ziggy:i}=C().props,{data:h,setData:b,post:S,processing:j,errors:J}=O(),l=$.language,E=e=>{e.preventDefault(),S(route("member.assessment.save"),{onSuccess:()=>{p.length>o+1?(f.visit(route("member.assessment.start",[d.id,{question:o+1}])),b({})):f.post(route("member.assessment.complete",d.id))}})};y.useEffect(()=>{var e,a;(e=i==null?void 0:i.query)!=null&&e.question&&k(parseInt((a=i==null?void 0:i.query)==null?void 0:a.question))},[i==null?void 0:i.query]),y.useEffect(()=>{var a;let e=localStorage.getItem("assessment");e&&(e=JSON.parse(e)),T.isEmpty(e)?g.forEach(s=>{s.assessment_question.type==="checkbox"?_(s.assessment_question_id,s.assessment_option_id):x(s.assessment_question_id,s.assessment_option_id)}):(a=Object.keys(e))==null||a.forEach(s=>{const n=e[s],t=s.split(".");t[0]==="checkbox"?n.forEach(c=>{_(t[1],c,!0)}):t[0]==="radio"&&x(t[1],n,!0)})},[g]);const x=(e,a,s)=>{var t;const n={[`radio.${e}`]:a,assessment_id:p[((t=i==null?void 0:i.query)==null?void 0:t.question)||0].id,session_id:d.id};b(c=>{const u={...c,...n};return s||localStorage.setItem("assessment",JSON.stringify(u)),u})},_=(e,a,s)=>{b(n=>{const t=n[`checkbox.${e}`]||[],c=t.includes(a)?{...n,[`checkbox.${e}`]:t.filter(u=>u!==a)}:{...n,[`checkbox.${e}`]:[...t,a]};return s||localStorage.setItem("assessment",JSON.stringify(c)),c})},q=()=>{o>0?f.visit(route("member.assessment.start",[d.id,{question:o-1}])):f.visit(route("member.assessment.index"))};return r(A,{children:m(w,{children:[r(M,{title:"assessment",className:"mb-6"}),r("div",{children:p.map((e,a)=>m("form",{onSubmit:E,className:`${o===a?"":"hidden"}`,children:[r("div",{className:"mb-4 flex justify-center",children:r("img",{src:`/storage/assessments/${l==="en"&&e.image_en?e.image_en:e.image}`,alt:""})}),r("div",{className:"font-bold mb-3 text-xl text-center",children:l==="en"&&e.title_en?e.title_en:e.title}),r("div",{dangerouslySetInnerHTML:{__html:l==="en"&&e.description_en?e.description_en:e.description},className:"text-center mb-10"}),e.assessment_question.map((s,n)=>m("div",{children:[r("div",{className:"font-bold text-lg",children:s.title}),r("div",{dangerouslySetInnerHTML:{__html:l==="en"&&s.question_en?s.question_en:s.question}}),r("div",{className:"mt-4",children:s.assessment_option.map(t=>m("div",{className:"flex items-center px-5 py-3 mb-4 rounded-3xl bg-lightPrimary bg-opacity-60",children:[s.type==="radio"?r("input",{type:"radio",name:`radio.${s.id}`,id:`option_${t.id}`,value:t.id,className:"mr-3 text-primary focus:ring-primary",checked:h[`radio.${s.id}`]===t.id,required:!0,onChange:()=>x(s.id,t.id)}):r("input",{type:"checkbox",name:`checkbox.${s.id}`,id:`option_${t.id}`,value:t.id,checked:h[`checkbox.${s.id}`]&&h[`checkbox.${s.id}`].includes(t.id),className:"mr-3 text-primary focus:ring-primary",onChange:()=>_(s.id,t.id)}),r("label",{htmlFor:`option_${t.id}`,className:"w-full",children:l==="en"&&t.option_en?t.option_en:t.option})]}))}),n+1!==e.assessment_question.length&&r("div",{className:"h-0.5 w-1/2 my-10 box-border left-1/2 mx-auto -translate-y-1/2 bg-gray-300"})]})),m("div",{className:"flex justify-center gap-6 mt-6",children:[r(N,{type:"button",onClick:q,className:"min-w-[160px] flex justify-center",color:"gray",children:v("back")}),r(N,{type:"submit",disabled:j,className:"min-w-[160px] flex justify-center",children:v("next")})]})]}))})]})})}export{Q as default};
